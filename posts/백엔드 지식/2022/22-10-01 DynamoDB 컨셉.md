---
title: DynamoDB 컨셉
date: 2022-10-01
---

## 주제: #DynamoDB #DB #AWS

## 메모

### 목차

- tables, items, and attributes
- primary keys
- secondary indexes
- read and write capacity

#### Tables, Items, and Attributes

테이블, 아이템, 어트리뷰트는 다이나모 디비의 가장 중요한 개념들입니다.

테이블은 데이터 레코드들의 묶음입니다. 예를 들어 유저 테이블에 유저 정보를 기록할 수 있고, 주문 테이블에 주문 정보를 기록할 수 있습니다. 이는 관계형 데이터베이스의 테이블이나 몽고디비의 컬렉션과 유사한 개념입니다.

아이템은 테이블 내에서의 단일 데이터 레코드입니다. 각각의 아이템은 프라이머리 키로 테이블 내에서 고유하게 식별됩니다. 유저 테이블에서 하나의 아이템은 특정한 유저를 나타냅니다. 여기서의 아이템은 관계형 데이터베이스의 열이나 몽고디비의 다큐먼트와 유사한 개념입니다.

속성은 개별 아이템에 포함된 데이터입니다. 이는 유저의 나이를 뜻하는 나이 정보가 될 수도 있고, 성별 정보 또한 될 수 있습니다. 다이나모 디비에서는 프라이머리 키를 제외하고는 특별하게 어트리뷰트 값을 요구하진 않습니다.

### Primary Key

테이블 내의 각각의 아이템은 고유한 프라이머리 키를 가집니다. 프라이머리 키의 정의는 테이블이 생성될 때 반드시 정의되어야 하며, 새로운 아이템을 추가했을 때 무조건 주어져야 합니다.

기본적으로 두 종류의 프라이머리 키가 존재합니다.

- `simple primary key` = "partition key"
  - key-value 스토어나 primary key로 SQL을 이용해 접근하는 것과 같습니다.
  - 예를 들어 유저 테이블에서 유저 이름을 프라이머리 키로 사용할 수 있습니다.
- `composite primary key` = "partition key" + "sort key"
  - sort key는 같은 파티션 내에 있는 아이템들을 정렬하는데 사용됩니다.
  - 예를 들어 주문 테이블에서 파티션 키는 CustomerId가 될 수 있고, 소트 키는 OrderId로 사용할 수 있습니다.

기본적으로 프라이머리 키는 아이템을 식별하는데 사용하기 때문에 simple primary key 방식을 이용하든, composite primary key를 이용하든 하나의 아이템을 식별할 수 있는 고유의 조합으로 이루어져야 합니다.

### Secondary Indexes

프라이머리 키는 테이블 내에서 고유한 아이템을 식별하는 데 사용한다하였습니다. 하지만 때로는 primary key없이 테이블을 쿼리해야할 때가 존재할 것 입니다. 이럴 때 다이나모디비는 세컨더리 인덱시스를 사용하여 추가적인 액세스 패턴을 제공해줍니다.

세컨더리 인덱시스 또한 두 종류의 방식이 존재합니다.

- `local secondary index` = 같은 파티션 키, but 다른 소트 키
  - 앞서 예를 든 주문 테이블에서 금액에 따라 고객의 주문을 정렬하고 싶다한다면, 로컬 세컨더리 인덱스에서 CustomerId를 파티션 키로 추가하고, 소트 키로 Amount를 설정하면 됩니다.
- `global secondary index` = 완전히 다른 새로운 파티션 키 정의
  - 주문 테이블에서 OrderId를 새로운 글로벌 세컨더리 인덱스로 설정한다면 우리는 기존의 파티션 키인 CustomerId가 없이도 주문을 조회할 수 있을 것 입니다.

### Read and Write Capacity

다른 데이터베이스를 사용할 때처럼 인스턴스(CPUs, RAM, Storage)를 선택할 필요가 없습니다. 다이나모 디비는 이 대신에 read and write capacity를 설정해야합니다. 이 단위들은 이 동작들이 초당 몇 번 수행할 수 있을지에 대한 설정을 의미합니다. 이는 기존의 인스턴스 단위의 과금 체계와는 전혀 다른 방식이고 사용하는 하는 만큼 지불하라는 새로운 방식을 제공합니다.

또한 다이나모 디비는 이에 대한 오토스케일링도 제공합니다. 이를 활용해 피크 타임에는 스케일 업하고, 그렇지 않은 경우에는 스케일 다운하여 비용을 절감할 수 있습니다.

## 참고문헌

## 연결문서
